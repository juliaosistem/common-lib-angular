<!-- Diálogo de edición CRUD -->
<p-dialog
  [(visible)]="visible"
  [modal]="true"
  [style]="{ width: '450px' }"
  header="Item Details"
  styleClass="p-fluid"
  (onHide)="onDialogHide()"
>
  <ng-template #content>
    @for (field of displayFields; track field.key) {
      <div class="field">
        <label [for]="field.key">{{ field.label }}</label>
        @switch (field.type) {
          @case ('text') {
            <input 
              pInputText 
              [id]="field.key" 
              [(ngModel)]="internalItem[field.key]"
              [class.ng-invalid.ng-dirty]="submitted && !internalItem[field.key]" />
          }
          @case ('number') {
            <p-inputNumber 
              [id]="field.key" 
              [(ngModel)]="internalItem[field.key]" 
              mode="decimal" />
          }
          @case ('checkbox') {
            <p-checkbox 
              [id]="field.key" 
              [(ngModel)]="internalItem[field.key]" 
              [binary]="true" />
          }
          @case ('select') {
            <p-select 
              [id]="field.key" 
              [(ngModel)]="internalItem[field.key]" 
              [options]="getSelectOptions(field.key)"
              optionLabel="label"
              optionValue="value"
              placeholder="Select {{field.label}}"
              [showClear]="true" />
          }
          @default {
            <input 
              pInputText 
              [id]="field.key" 
              [(ngModel)]="internalItem[field.key]" />
          }
        }
        @if (submitted && field.key === 'name' && !internalItem[field.key]) {
          <small class="p-error">{{field.label}} is required.</small>
        }
      </div>
    }
  </ng-template>
  
  <ng-template #footer>
    <p-button 
      label="Cancel" 
      icon="pi pi-times" 
      [text]="true" 
      (click)="hideDialog()" />
    <p-button 
      label="Save" 
      icon="pi pi-check" 
      [text]="true" 
      (click)="saveItem()" />
  </ng-template>
</p-dialog>

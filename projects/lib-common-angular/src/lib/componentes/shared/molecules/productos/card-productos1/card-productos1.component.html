<div class="product-card shadow-md rounded-xl bg-white overflow-hidden transition-all duration-300 hover:shadow-lg">
    @if (product) {

        <!-- Imagen principal -->
        <div class="relative bg-gray-100 h-72 flex items-center justify-center overflow-hidden">

            <img 
                [src]="currentImageUrl" 
                [alt]="product.name" 
                class="h-full w-full object-cover transition-transform duration-300 hover:scale-105 cursor-pointer"
                (click)="navigateToProductDetail()"
            />

            <!-- Botón WhatsApp (Posicionado arriba a la derecha) -->
            <button 
                (click)="shareProductOnWhatsapp()"
                class="absolute top-3 right-3 bg-green-500 hover:bg-green-600 text-white p-3 rounded-full shadow-lg z-10"
            >
                <i class="pi pi-whatsapp text-xl"></i>
            </button>

        </div>

        <!-- Contenido -->
        <div class="p-4">

            <!-- Thumbnails (Slider horizontal) -->
            <div class="flex gap-2 overflow-x-auto pb-2 scrollbar-hide">
                @for (image of product.imagen; track $index) {
                    <img 
                        [src]="image.url"
                        (click)="selectImage($index)"
                        class="h-12 w-12 object-cover rounded-md cursor-pointer border shrink-0
                        transition-all duration-200"
                        [class.border-black]="isActiveThumbnail($index)"
                        [class.opacity-60]="!isActiveThumbnail($index)"
                    />
                }
            </div>

            <!-- Separador -->
            <hr class="border-gray-200 my-3">

            <h3 class="text-lg font-semibold text-gray-800 leading-tight">
                {{ product.name }}
            </h3>

           
            <!-- Detalles con fondo gris claro -->
            <div class="bg-gray-50 p-3 rounded-lg border border-gray-100 text-sm text-gray-600 space-y-1 mb-3">
                <div class="flex justify-between">
                    <strong>Categoría:</strong> 
                    <span>{{ product.idCategoria }}</span>
                </div>
                <div class="flex justify-between">
                    <strong>Disponibles:</strong> 
                    <span>{{ product.cantidad }}</span>
                </div>
            </div>

            <!-- Precios -->
            <div class="mt-3">
                @if(product.descuento && product.descuento > 0) {
                    <p class="text-gray-400 line-through text-sm">
                        {{ product.precios[0].precio | currency:product.precios[0].codigo_iso:'code' }}
                    </p>
                }

                <p class="text-xl font-bold text-gray-900">
                    {{ discount | currency:product.precios[0].codigo_iso:'code' }}
                </p>
            </div>

            @if(product.descuento && product.descuento > 0) {
                <div class="mt-2 inline-block bg-green-100 text-green-600 px-2 py-1 text-xs font-semibold rounded">
                    {{ product.descuento }}% OFF
                </div>
            }

            <!-- Separador antes de botones -->
            <hr class="border-gray-200 my-4">

            <!-- Botones -->
            <div class="flex flex-col gap-2">

                <!-- Personalizar (va al detalle) -->
                <button
                    (click)="navigateToProductDetail()"
                    class="w-full bg-black text-white py-2 rounded-lg text-sm font-medium 
                    hover:bg-gray-900 transition-colors shadow"
                >
                    PERSONALIZAR
                </button>

                <!-- Compartir general -->
                <button 
                    (click)="shareProduct()"
                    class="w-full bg-black text-white py-2 rounded-lg flex items-center justify-center gap-2 text-sm font-medium hover:bg-gray-900 transition-colors"
                >
                    <i class="pi pi-share-alt"></i>
                    COMPARTIR
                </button>

                <!-- Add to cart -->
                <lib-button-add-to-card1
                    class="w-full flex justify-center"
                    [product]="product" 
                    (addToCart)="onAddToCart($event)">
                </lib-button-add-to-card1>

            </div>

        </div>

    } @else {
        <div class="p-4 text-center text-gray-500">Producto no disponible</div>
    }
</div>

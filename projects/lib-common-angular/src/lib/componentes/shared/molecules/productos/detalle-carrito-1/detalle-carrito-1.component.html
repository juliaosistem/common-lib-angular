@if (product) {
<div id="product-container" class="container mx-auto max-w-7xl bg-white shadow-xl rounded-2xl p-6 md:p-12 lg:p-16">
        <!-- Contenedor principal de la página de detalle -->
        <div class="grid grid-cols-1 md:grid-cols-[104px_1fr] lg:grid-cols-[120px_1fr] gap-6 lg:gap-10">
            <!-- Columna miniaturas (vertical) + imagen principal -->
            <div class="grid grid-cols-[104px_1fr] lg:grid-cols-[120px_1fr] gap-4 lg:gap-6">
                <!-- Miniaturas verticales -->
                @if (product.imagen && product.imagen.length > 0) {
                <div class="thumbnails-rail space-y-3 lg:space-y-4">
                    @for (imagen of product.imagen; track $index) {
                        <button type="button" class="thumbnail-container rounded-lg cursor-pointer" (click)="updateMainImage(imagen.url)">
                            <div class="thumbnail" [class.thumbnail-active]="isActiveThumbnail(imagen.url)">
                                <img [src]="imagen.url" alt="Miniatura {{ imagen.alt }}" />
                            </div>
                        </button>
                    }
                </div>
                }
                <!-- Imagen principal -->
                <div class="main-image-frame bg-gray-100 rounded-xl flex justify-center items-center">
                    <p-image
                        [src]="selectedImageUrl"
                        [alt]="product.imagen[0].alt || product.name"
                        class="main-image rounded-xl"
                        [preview]="true">
                    </p-image>
                </div>
            </div>

            <!-- Columna de información del producto -->
            <div class="flex flex-col justify-between">
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <h1 class="text-3xl font-bold text-gray-900">{{ product.name }}</h1>
                        <p-button 
                            [text]="true" 
                            [rounded]="true"
                            (onClick)="toggleFavorite()"
                            [icon]="isFavorite ? 'pi pi-heart-fill' : 'pi pi-heart'"
                            [class]="isFavorite ? 'text-red-500' : 'text-gray-400'"
                            class="hover:text-red-500 transition-colors">
                        </p-button>
                    </div>

                    <!-- esta es la parte de reseñas -->
                    <!-- <div class="flex items-center space-x-2 mb-6">
                        <p-rating 
                            [ngModel]="product.rating" 
                            [readonly]="true"
                            class="text-yellow-500">
                        </p-rating>
                        <span class="text-gray-500 text-sm">({{ product.reviews }}) reseñas</span>
                    </div> -->

                    <p class="text-gray-600 leading-relaxed mb-6 lg:mb-8">{{ product.descripcion }}</p>

                    <div class="flex items-center gap-4 mb-6 lg:mb-8">
                        @if(isLogin){
                            @if(product.descuento != undefined && product.descuento > 0) {
                                <span class="old-price">{{ product.precios[0].precio | currency:product.precios[0].codigo_iso :'code' }}</span>
                                <span class="discount-label">{{ product.descuento}}% OFF</span>
                            }
                            <span class="current-price">{{ discount | currency:product.precios[0].codigo_iso :'code'}}</span>
                        } @else {
                            <a
                                class="contact-btn"
                                [href]="getWhatsAppLink()"
                                target="_blank" rel="noopener noreferrer"
                                aria-label="Contactar por WhatsApp">
                                <i class="pi pi-whatsapp"></i>
                                <span>Contactar</span>
                            </a>
                        }
                    </div>

                    <!-- Badges informativos -->
                    <div class="info-badges mb-6">
                        <div class="badge"><i class="pi pi-shield"></i><span>Compra protegida</span></div>
                        <div class="badge"><i class="pi pi-truck"></i><span>Entrega rápida</span></div>
                        <div class="badge"><i class="pi pi-refresh"></i><span>Devolución 30 días</span></div>
                    </div>
                </div>

                <div class="cta-card">
                    <!-- <div class="flex items-center mb-8">
                        <label class="text-gray-700 font-medium mr-4">Cantidad:</label>
                        <div class="flex items-center space-x-2">
                            <p-button 
                                icon="pi pi-minus" 
                                [text]="true" 
                                [rounded]="true"
                                (onClick)="decrementQuantity()"
                                class="quantity-btn">
                            </p-button>
                            <span class="w-16 text-center font-bold text-lg text-gray-800">{{ currentQuantity }}</span>
                            <p-button 
                                icon="pi pi-plus" 
                                [text]="true" 
                                [rounded]="true"
                                (onClick)="incrementQuantity()"
                                class="quantity-btn">
                            </p-button>
                        </div>
                    </div> -->

                    <lib-button-add-to-card1 ></lib-button-add-to-card1>

                    @if (showCartMessage) {
                        <div class="mt-4 text-center text-sm font-semibold text-green-600">
                            Producto añadido al carrito.
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
} @else {
    <div class="container mx-auto max-w-7xl bg-white shadow-xl rounded-2xl p-6 md:p-12 lg:p-16">
        <div class="flex justify-center items-center h-64">
            <p class="text-gray-500 text-lg">Cargando producto...</p>
        </div>
    </div>
}
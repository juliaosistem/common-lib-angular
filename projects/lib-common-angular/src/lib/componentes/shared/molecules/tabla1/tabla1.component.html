<!-- Tabla -->
<p-table
  #dt
  [value]="data"
  [rows]="10"
  [paginator]="true"
  [globalFilterFields]="['name']"
  [tableStyle]="{ 'min-width': '75rem' }"
  [(selection)]="selectedItems"
  [rowHover]="true"
  dataKey="id"
  currentPageReportTemplate="Showing {first} to {last} of {totalRecords} items"
  [showCurrentPageReport]="true"
  [rowsPerPageOptions]="[10, 20, 30]"
>
  <ng-template #caption>
    <div class="flex items-center justify-between">
      <h5 class="m-0">{{tableTitle}}</h5>
      <p-button label="New" icon="pi pi-plus" severity="success" (click)="onEditItem({})" />
    </div>
  </ng-template>
  
  <ng-template #header>
    <tr>
      <th style="width: 3rem"><p-tableHeaderCheckbox /></th>
      @for (field of displayFields; track field.key) {
        <th style="min-width: 12rem">{{ field.label }}</th>
      }
      <th style="min-width: 12rem">Actions</th>
    </tr>
  </ng-template>
  
  <ng-template #body let-item>
    <tr>
      <td style="width: 3rem"><p-tableCheckbox [value]="item" /></td>
      @for (field of displayFields; track field.key) {
        <td>
          @switch (field.type) {
            @case ('img') {
              <img [src]="getImageUrl(field, item[field.key])" [alt]="getImageAltText(field, item)" style="width: 64px" class="rounded" />
            }
            @case ('checkbox') {
               <span class="flex items-center gap-2">
                  <i [class]="item[field.key] ? 'pi pi-check-circle text-green-500' : 'pi pi-times-circle text-red-500'"></i>
                  <span>{{ item[field.key] ? 'Yes' : 'No' }}</span>
                </span>
            }
            @default {
              <span>{{ formatDynamicFieldValue(field, item[field.key]) }}</span>
            }
          }
        </td>
      }
      <td>
        <p-button icon="pi pi-pencil" class="mr-2" [rounded]="true" [outlined]="true" severity="info" (click)="onEditItem(item)" />
        <p-button icon="pi pi-trash" severity="danger" [rounded]="true" [outlined]="true" (click)="onDeleteItem(item)" />
      </td>
    </tr>
  </ng-template>
</p-table>

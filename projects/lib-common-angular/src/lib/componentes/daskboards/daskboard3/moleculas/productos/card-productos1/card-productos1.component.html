<div class="product-card flex flex-col h-full rounded-xl shadow-lg hover:shadow-2xl transition-shadow duration-300 overflow-hidden bg-white">
    <!-- Contenedor de la imagen principal y la galería de miniaturas que se muestra con hover -->
    <div class="main-image-container relative group" 
         (mouseenter)="onMouseEnter()" 
         (mouseleave)="onMouseLeave()">
        
        <!-- Slider de imágenes -->
        <div class="image-slider">
            <img [src]="currentImageUrl" 
                 [alt]="product.name + ' - ' + currentColor" 
                 class="transition-opacity duration-500 active">
        </div>
        
        <!-- Información de la imagen (color) -->
        <div class="image-info">
            Color: <span>{{ currentColor }}</span>
        </div>

        <!-- Controles del slider -->
        <div class="slider-controls">
            <p-button 
                icon="pi pi-chevron-left" 
                [text]="true" 
                [rounded]="true"
                (onClick)="prevImage()"
                class="p-2">
            </p-button>
            <p-button 
                icon="pi pi-chevron-right" 
                [text]="true" 
                [rounded]="true"
                (onClick)="nextImage()"
                class="p-2">
            </p-button>
        </div>
        
        <!-- Botón de compartir por WhatsApp -->
        <p-button 
            icon="pi pi-whatsapp" 
            [text]="true" 
            [rounded]="true"
            (onClick)="shareProductOnWhatsapp()"
            class="share-btn-whatsapp text-2xl">
        </p-button>
        
        <!-- Galería de miniaturas que aparece al hacer hover -->
        <div class="thumbnail-gallery grid grid-cols-5 gap-2 group-hover:flex">
            <div *ngFor="let image of product.images; let i = index" 
                 class="thumbnail-container rounded-lg cursor-pointer"
                 (click)="selectImage(i)">
                <div class="thumbnail" [class.active]="isActiveThumbnail(i)">
                    <img [src]="image.url" [alt]="'Miniatura de color ' + image.color">
                </div>
            </div>
        </div>
    </div>

    <!-- Contenido del producto -->
    <div class="flex-grow flex flex-col p-4 md:p-6 text-gray-800">
        <h3 class="text-lg md:text-xl font-semibold mb-2 line-clamp-2">{{ product.name }}</h3>
        <p class="text-sm text-gray-500 mb-2">Por {{ product.brand }}</p>
        
        <div class="flex items-center justify-between mb-4 text-sm text-gray-600">
            <span class="font-medium">Categoría: {{ product.category }}</span>
            <span class="font-medium text-green-600">Cantidad disponible: {{ product.stock }}</span>
        </div>

        <!-- Precios y descuento -->
        <div class="mt-auto">
            <div class="flex items-end mb-4">
                <span class="old-price text-sm mr-2">${{ formatPrice(product.oldPrice) }}</span>
                <span class="text-2xl font-bold text-gray-900">${{ formatPrice(product.price) }}</span>
            </div>
            
            <!-- Botones de acción y cuotas -->
            <div class="flex flex-col md:flex-row md:justify-between items-start md:items-center space-y-2 md:space-y-0">
                <span class="discount-badge text-xs font-semibold px-2 py-1 rounded-full">{{ discount }}% OFF</span>
                <span class="text-xs text-green-600">3 cuotas de ${{ installmentPrice }} con 0% interés</span>
            </div>
            
            <!-- Contenedor de botones de acción -->
            <div class="flex flex-col md:flex-row md:space-x-4 space-y-4 md:space-y-0 mt-6">
                <!-- Botón inicial de Agregar al carrito -->
                <p-button 
                    *ngIf="!showQuantitySelector"
                    label="Agregar al carrito"
                    icon="pi pi-shopping-cart"
                    (onClick)="handleAddToCart()"
                    class="flex-1 bg-blue-600 text-white font-bold py-3 px-4 rounded-lg shadow-md hover:bg-blue-700 transition-colors transform hover:scale-105">
                </p-button>

                <!-- Selector de cantidad -->
                <div *ngIf="showQuantitySelector"
                     class="flex-1 flex items-center justify-between bg-blue-600 text-white font-bold py-3 px-4 rounded-lg shadow-md">
                    <p-button 
                        icon="pi pi-minus" 
                        [text]="true"
                        (onClick)="decrementQuantity()"
                        class="text-white hover:text-blue-200 focus:outline-none transition-colors">
                    </p-button>
                    <span class="text-xl font-bold">{{ selectedQuantity }}</span>
                    <p-button 
                        icon="pi pi-plus" 
                        [text]="true"
                        (onClick)="incrementQuantity()"
                        class="text-white hover:text-blue-200 focus:outline-none transition-colors">
                    </p-button>
                </div>
                
                <p-button 
                    label="Compartir"
                    icon="pi pi-share-alt"
                    (onClick)="shareProduct()"
                    class="flex-1 bg-gray-200 text-gray-800 font-bold py-3 px-4 rounded-lg shadow-md hover:bg-gray-300 transition-colors transform hover:scale-105">
                </p-button>
            </div>
        </div>
    </div>
</div>
